<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Batalla de Monstruos (Manual)</title>
  <style>
    body{
      margin:0; font-family:Arial, sans-serif;
      background:#101522; color:#e0e0e0; padding:20px;
    }
    h1{text-align:center; margin-bottom:10px}
    .row{display:flex; gap:10px; justify-content:center; margin-bottom:15px}
    button{
      background:#1f2937; color:#e5e7eb; border:1px solid #374151;
      padding:8px 12px; border-radius:8px; cursor:pointer;
    }
    table{width:100%; border-collapse:collapse; margin-top:10px}
    th,td{border:1px solid #333; padding:8px; text-align:center}
    thead{background:#222}
    .last{background:rgba(255,0,0,0.25)}
  </style>
</head>
<body>
  <h1>Batalla de Monstruos</h1>
  <div class="row">
    <button id="btnStart">Iniciar juego</button>
    <button id="btnRound">Iniciar ronda</button>
    <button id="btnReset">Reiniciar</button>
  </div>

  <div id="status"></div>
  <table id="tabla"></table>
  <div id="log" style="margin-top:10px; background:#151a27; padding:10px; border-radius:8px; height:180px; overflow:auto;"></div>

  <script>
    
    //variables con los monstruos, vida, turnos, poderes etc
    
    let monstruos = ["Drako","ZombieX","Furia","Golem"];
    let vida = [100,100,100,100];
    let turnos = [3,3,3,3];
    let poderes = [];
    let ultimoAtacado = -1;
    let juegoTerminado = false;

    const tabla = document.getElementById("tabla");
    const log = document.getElementById("log");
    const status = document.getElementById("status");

    
    //generar numeros randoms
   
    function aleatorio(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

    
    //para generar matrices
    
    function generarPoderes(){
      poderes = [];
      for(let i=0;i<4;i++){
        poderes.push([aleatorio(10,30), aleatorio(10,30), aleatorio(10,30)]);
      }
    }

    
    //actualizar la tabla
    
    function actualizarTabla(){
      let html = "<thead><tr><th>Monstruo</th><th>A1</th><th>A2</th><th>A3</th><th>Vida</th><th>Turnos</th></tr></thead><tbody>";
      for(let i=0;i<4;i++){
        html += `<tr ${i===ultimoAtacado?'class=\"last\"':''}>
          <td>${monstruos[i]}</td>
          <td>${poderes[i][0]}</td>
          <td>${poderes[i][1]}</td>
          <td>${poderes[i][2]}</td>
          <td>${vida[i]}</td>
          <td>${turnos[i]}</td>
        </tr>`;
      }
      html += "</tbody>";
      tabla.innerHTML = html;
      status.textContent = `Vivos: ${vida.filter(v=>v>0).length} · Con turnos: ${turnos.filter((t,i)=>vida[i]>0 && t>0).length}`;
    }

    
    //agregar lo que pasa en el log 
    
    function agregarLog(texto){
      const p = document.createElement("div");
      p.textContent = texto;
      log.appendChild(p);
      log.scrollTop = log.scrollHeight;
    }

    
    //jugar ronda por ronda
    
    function jugarRonda(){
      if(juegoTerminado) return;
      let atacantes = [];
      for(let i=0;i<4;i++){
        if(vida[i]>0 && turnos[i]>0) atacantes.push(i);
      }
      if(atacantes.length===0){ finalizarJuego(); return; }

      let a = atacantes[aleatorio(0, atacantes.length-1)];
      let posibles = [];
      for(let j=0;j<4;j++){
        if(j!==a && vida[j]>0) posibles.push(j);
      }
      if(posibles.length===0){ finalizarJuego(); return; }

      let d = posibles[aleatorio(0, posibles.length-1)];
      let idx = (turnos[a]>=3)?2:(turnos[a]===2?1:0);
      let dano = poderes[a][idx];

      vida[d] = Math.max(0, vida[d]-dano);
      turnos[a] = Math.max(0, turnos[a]-1);
      ultimoAtacado = d;

      agregarLog(`${monstruos[a]} usa A${idx+1} (${dano}) sobre ${monstruos[d]} → vida ${vida[d]}`);
      actualizarTabla();
      verificarEstado();
    }

    
    //verificar si hay empate o victoria
    
    function verificarEstado(){
      const vivos = vida.filter(v=>v>0);
      const quedanTurnos = turnos.some((t,i)=>t>0 && vida[i]>0);

      if(vivos.length===1){
        let idx = vida.findIndex(v=>v>0);
        agregarLog(`🏆 ${monstruos[idx]} gana con ${vida[idx]} de vida.`);
        status.textContent = "Juego terminado: hay un ganador.";
        juegoTerminado = true;
      }
      else if(!quedanTurnos){
        let maxVida = Math.max(...vida);
        let ganadores = monstruos.filter((m,i)=>vida[i]===maxVida);
        if(ganadores.length===1) agregarLog(`🏆 ${ganadores[0]} gana por mayor vida (${maxVida})`);
        else agregarLog(`🤝 Empate entre: ${ganadores.join(", ")} (${maxVida} de vida)`);
        status.textContent = "Juego terminado: sin turnos restantes.";
        juegoTerminado = true;
      }
    }

    function finalizarJuego(){
      agregarLog("No hay más ataques posibles.");
      verificarEstado();
    }

    // -----------------------------
    //boton iniciar juego
    // -----------------------------
    document.getElementById("btnStart").onclick = ()=>{
      log.innerHTML="";
      generarPoderes();
      vida=[100,100,100,100];
      turnos=[3,3,3,3];
      ultimoAtacado=-1;
      juegoTerminado=false;
      agregarLog("Comienza la batalla...");
      actualizarTabla();
    };

    
    //boton para jugar una ronda
    
    document.getElementById("btnRound").onclick = ()=>{
      jugarRonda();
    };

    
    //boton para reinicar
    
    document.getElementById("btnReset").onclick = ()=>{
      log.innerHTML="";
      tabla.innerHTML="";
      status.textContent="";
      agregarLog("Juego reiniciado.");
      juegoTerminado=false;
    };
  </script>
</body>
</html>